<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ë‚¨ëŒ€í•™êµ í¡ì…ê¸° ì‚¬ìš© AI ì§„ë‹¨</title>

    <!-- CSS -->
    <link rel="stylesheet" href="css/utils/reset.css">
    <link rel="stylesheet" href="css/utils/variables.css">
    <link rel="stylesheet" href="css/components/header.css">
    <link rel="stylesheet" href="css/components/menu.css">
    <link rel="stylesheet" href="css/components/main-section.css?v=4">
    <link rel="stylesheet" href="css/components/results.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- Plotly.js for visualization -->
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
</head>

<body>
    <!-- Header Section -->
    <header class="app-header">
        <div class="header-content">
            <h1 class="header-title">ì „ë‚¨ëŒ€í•™êµ AI ê¸°ë°˜ í¡ì…ê¸° ì‚¬ìš©ë²• í‰ê°€ ì‹œìŠ¤í…œ</h1>
        </div>
    </header>

    <!-- Menu Bar Section -->
    <nav class="menu-bar">
        <button id="deviceSelect" class="menu-btn">
            1. ê¸°ê¸° ì„ íƒ <span class="dropdown-icon">â–¼</span>
        </button>
        <button id="fileUpload" class="menu-btn" disabled>2. íŒŒì¼</button>
        <button id="analyze" class="menu-btn" disabled>3. ë¶„ì„</button>
        <button id="save" class="menu-btn" disabled>4. ì €ì¥</button>

        <!-- Device Dropdown -->
        <div id="deviceDropdown" class="dropdown-menu" style="display: none;">
            <div class="dropdown-item" data-device-id="pMDI_type1">
                <span class="device-name">pMDI_type1(Suspension pressurized metered-dose inhaler)</span>
                <span class="device-desc">Ventolin Evohaler, Flixotide Evohaler, Seretide Evohaler, Symbicort Rapihaler,
                    Flutiform Inhaler</span>
            </div>
            <div class="dropdown-item" data-device-id="pMDI_type2">
                <span class="device-name">pMDI_type2(Solution pressurized metered-dose inhaler)</span>
                <span class="device-desc">Alvesco Inhaler, Foster</span>
            </div>
            <div class="dropdown-item" data-device-id="DPI_type1">
                <span class="device-name">DPI_type1(Multi-dose cap-opening dry powder inhaler)</span>
                <span class="device-desc">Anoro Ellipta, Relvar Ellipta, Incruse Ellipta, Trelegy Ellipta, Foster
                    Nexthaler</span>
            </div>
            <div class="dropdown-item" data-device-id="DPI_type2">
                <span class="device-name">DPI_type2(Multi-dose rotating/button-actuated dry powder inhaler)</span>
                <span class="device-desc">Eklira Genuair, Duaklir Genuair, Symbicort Turbuhaler, Pulmicort
                    Turbuhaler</span>
            </div>
            <div class="dropdown-item" data-device-id="DPI_type3">
                <span class="device-name">DPI_type3(Single-dose capsule-based dry powder inhaler)</span>
                <span class="device-desc">Xoterna Breezhaler, Spiriva Handihaler</span>
            </div>
            <div class="dropdown-item" data-device-id="SMI_type1">
                <span class="device-name">SMI_type1(Soft mist inhaler)</span>
                <span class="device-desc">Vahelva Respimat, Spiriva Respimat</span>
            </div>
        </div>
    </nav>

    <!-- Main Section -->
    <main class="main-section" id="mainSection">
        <!-- State: Idle -->
        <div id="idleState" class="state-content state-idle">
            <div class="placeholder">
                <div class="icon-upload">ğŸ“¤</div>
                <h2>í¡ì…ê¸° ì‚¬ìš© ë¹„ë””ì˜¤ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</h2>
                <p>ì§€ì› í˜•ì‹: MP4, MOV, AVI, MKV</p>
                <p>ìµœëŒ€ í¬ê¸°: 500MB</p>
            </div>
        </div>

        <!-- State: Device Selected -->
        <div id="deviceInfoState" class="state-content" style="display: none;">
            <div class="device-info">
                <h3>ì„ íƒëœ ê¸°ê¸°</h3>
                <div class="device-badge">
                    <span class="device-type" id="selectedDeviceType"></span>
                    <span class="device-name" id="selectedDeviceName"></span>
                </div>
            </div>
        </div>

        <!-- State: Video Preview -->
        <div id="videoPreviewState" class="state-content" style="display: none;">
            <div class="video-preview">
                <div class="video-container">
                    <video id="videoPlayer" controls></video>
                </div>
                <div class="video-info">
                    <h4>ë¹„ë””ì˜¤ ì •ë³´</h4>
                    <table>
                        <tr>
                            <td>íŒŒì¼ëª…:</td>
                            <td><strong id="fileName">-</strong></td>
                        </tr>
                        <tr>
                            <td>ì¬ìƒì‹œê°„:</td>
                            <td><strong id="duration">-</strong></td>
                        </tr>
                        <tr>
                            <td>í¬ê¸°:</td>
                            <td><strong id="fileSize">-</strong></td>
                        </tr>
                        <tr>
                            <td>í•´ìƒë„:</td>
                            <td><strong id="resolution">-</strong></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <!-- State: Analyzing -->
        <div id="analyzingState" class="state-content" style="display: none;">
            <div class="analysis-progress">
                <h3>ë¶„ì„ ì§„í–‰ ì¤‘...</h3>

                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    <span class="progress-text" id="progressText">0%</span>
                </div>

                <div class="current-stage">
                    <p>í˜„ì¬ ë‹¨ê³„: <strong id="currentStage">ì´ˆê¸°í™” ì¤‘...</strong></p>
                    <p>ì˜ˆìƒ ì†Œìš” ì‹œê°„: <strong id="estimatedTime">ê³„ì‚° ì¤‘...</strong></p>
                </div>

                <div class="agent-logs">
                    <h4>ì²˜ë¦¬ ë¡œê·¸</h4>
                    <ul id="logList">
                        <li class="log-info">ë¶„ì„ ì‹œì‘ ì¤€ë¹„ ì¤‘...</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- State: Results -->
        <div id="resultsState" class="state-content" style="display: none;">
            <div class="analysis-results">
                <h3>ë¶„ì„ ê²°ê³¼</h3>

                <!-- Summary Section -->
                <div class="summary-section">
                    <div class="summary-card">
                        <h4>ì´ì </h4>
                        <div class="score-display">
                            <span class="score-value" id="scoreValue">-</span>
                            <span class="score-max">/13</span>
                        </div>
                        <div class="score-percentage" id="scorePercentage">-%</div>
                    </div>

                    <div class="summary-card">
                        <h4>ì‚¬ìš© ëª¨ë¸</h4>
                        <p id="modelInfo">-</p>
                    </div>

                    <div class="summary-card">
                        <h4>ë¶„ì„ ì‹œê°„</h4>
                        <p id="analysisTime">-</p>
                    </div>
                </div>

                <!-- Reference Times - Hidden as per user request -->
                <div class="reference-times" style="display: none;">
                    <h4>ê¸°ì¤€ ì‹œì  (Reference Times)</h4>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>í•­ëª©</th>
                                <th>ì‹œê°„ (ì´ˆ)</th>
                                <th>ì„¤ëª…</th>
                            </tr>
                        </thead>
                        <tbody id="referenceTimesBody">
                            <tr>
                                <td>inhalerIN</td>
                                <td class="time-value">-</td>
                                <td>í¡ì…ê¸°ê°€ ì²˜ìŒ ë³´ì´ëŠ” ì‹œì </td>
                            </tr>
                            <tr>
                                <td>faceONinhaler</td>
                                <td class="time-value">-</td>
                                <td>í¡ì…ê¸°ë¥¼ ì…ì— ëŒ€ëŠ” ì‹œì </td>
                            </tr>
                            <tr>
                                <td>inhalerOUT</td>
                                <td class="time-value">-</td>
                                <td>í¡ì…ê¸°ê°€ ì‚¬ë¼ì§€ëŠ” ì‹œì </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Action Steps -->
                <div class="action-steps">
                    <h4>í–‰ë™ ë‹¨ê³„ ë¶„ì„ (13ë‹¨ê³„)</h4>
                    <div class="action-list" id="actionList">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <!-- Visualization - Hidden as per user request -->
                <div class="visualization" style="display: none;">
                    <h4>íƒ€ì„ë¼ì¸ ì‹œê°í™”</h4>
                    <div id="timelineChart" class="chart-container"></div>
                </div>
            </div>
        </div>

        <!-- Error State -->
        <div id="errorState" class="state-content error-message" style="display: none;">
            <div class="error-content">
                <div class="error-icon">âš ï¸</div>
                <h3 id="errorTitle">ì˜¤ë¥˜ ë°œìƒ</h3>
                <p id="errorMessage"></p>
                <button id="retryBtn" class="btn-primary">ë‹¤ì‹œ ì‹œë„</button>
            </div>
        </div>
    </main>

    <!-- File Input (Hidden) -->
    <input type="file" id="fileInput" accept="video/mp4,video/quicktime,video/x-msvideo,video/x-matroska"
        style="display: none;">

    <!-- Modal for errors -->
    <div id="errorModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="modalTitle">ì˜¤ë¥˜</h3>
            <p id="modalMessage"></p>
            <div class="modal-actions">
                <button id="modalClose" class="btn-secondary">ë‹«ê¸°</button>
            </div>
        </div>
    </div>

    <!-- TypeScript (compiled to JavaScript) -->
    <script type="module" src="dist/main.js?v=2"></script>
</body>

</html>